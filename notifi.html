<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notificaciones en el sitio</title>
</head>
<body>

<button onclick="showNotification()">Mostrar Notificación</button>

<script>
    // Registrar el Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js')
            .then(function(registration) {
                console.log('Service Worker registrado con éxito:', registration);
            })
            .catch(function(error) {
                console.log('Error al registrar el Service Worker:', error);
            });
    }

    // Función para mostrar la notificación cuando el usuario hace clic
    function showNotification() {
        if ('Notification' in window && navigator.serviceWorker) {
            if (Notification.permission === 'granted') {
                navigator.serviceWorker.ready.then(function(registration) {
                    registration.showNotification('¡Notificación Activa!', {
                        body: 'Gracias por hacer clic en el botón.',
                        icon: 'IcoLogo.png' // Asegúrate de usar un ícono válido
                    });
                });
            } else if (Notification.permission === 'default') {
                // Solicitar permiso si no ha sido otorgado
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        showNotification(); // Intentar mostrar la notificación de nuevo
                    }
                });
            } else {
                alert('No se pueden mostrar notificaciones sin permiso.');
            }
        } else {
            alert('Tu navegador no soporta notificaciones o Service Workers.');
        }
    }
</script>

</body>
</html>